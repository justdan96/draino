{
  "title": "[compute] [nla] Node Lifecycle Automation",
  "description": "## Node Life Cycle Automation\n[Documentation](https://infra-docs.us1.prod.dog/kubernetes/kubernetes/node-lifecycle/)\n## Related Dashboards\n[Dashboard list](https://app.datadoghq.com/dashboard/lists?q=%5Bcompute%5D+%5Bnla%5D)\n## Contact\n[Slack](https://dd.slack.com/archives/C010UB763NE)\n\n## Logs query\n[my pod](https://app.datadoghq.com/logs?query=%40objectRef.resource%3A%28events%20OR%20pods%29%20%28%40requestObject.involvedObject.name%3ApodName%20OR%20%40objectRef.name%3ApodName%29%20-%40http.method%3Aget%20-%40objectRef.subresource%3Aeviction&cols=kubernetes_cluster%2C%40requestObject.metadata.namespace%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true) : replace {podName} by the real value in the logs query.\n\n@david.benque",
  "widgets": [
    {
      "id": 4647566357591622,
      "definition": {
        "type": "note",
        "content": "\n[Documentation](https://datadoghq.atlassian.net/wiki/spaces/K8S/pages/2274623742/NLA+-+Node+Lifecycle+Automation) | [FAQ](https://datadoghq.atlassian.net/wiki/spaces/K8S/pages/2277966820/NLA+-+FAQ) |\n[Dashboard list](https://app.datadoghq.com/dashboard/lists?q=%5Bcompute%5D+%5Bnla%5D) | [Slack](https://dd.slack.com/archives/C010UB763NE)\n",
        "background_color": "white",
        "font_size": "24",
        "text_align": "center",
        "vertical_align": "top",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left",
        "has_padding": true
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 5,
        "height": 2
      }
    },
    {
      "id": 5302483934625036,
      "definition": {
        "type": "note",
        "content": "Audit logs for **[my pod](../../logs?query=%40objectRef.resource%3A%28events%20OR%20pods%29%20%28%40requestObject.involvedObject.name%3ApodName%20OR%20%40objectRef.name%3ApodName%29%20%40requestObject.source.component%3Adraino&cols=kubernetes_cluster%2C%40requestObject.metadata.namespace%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true)** , **[my node](https://app.datadoghq.com/logs?query=%40objectRef.resource%3A%28events%20OR%20nodes%29%20%28%40requestObject.involvedObject.name%3AnodeName%20OR%20%40objectRef.name%3AnodeName%29%20-%40http.method%3A%28get%20OR%20watch%29%20%40requestObject.source.component%3Adraino&cols=kubernetes_cluster%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.spec.unschedulable%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true)** and [evictions](https://app.datadoghq.com/logs?query=%40usr.name%3A%22system%3Aserviceaccount%3Acluster-controllers%3Adraino%22%20%20%40requestObject.reason%3A%28Evictio%2A%20OR%20Cordo%2A%20OR%20Uncord%2A%20OR%20Drain%2A%29&agg_m=count&agg_q=%40requestObject.involvedObject.name&agg_t=count&cols=kubernetes_cluster%2C%40requestObject.involvedObject.kind%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message%2C%40requestObject.involvedObject.name&index=k8s-audit&messageDisplay=inline&sort_m=&sort_t=&stream_sort=time%2Cdesc&top_n=10&top_o=top&viz=stream&from_ts=1637942472685&to_ts=1637946072685&live=true)\n\nreplace {podName|nodeName} by the real value in the logs query + set time window\n\n---\n\n[Detailed node investigation](https://app.datadoghq.com/dashboard/6ah-rai-6w3/nla-node-investigation?from_ts=1680436847473&to_ts=1680609647473&live=true)\nwhere you can find more information about why a node is not being drained.",
        "background_color": "white",
        "font_size": "16",
        "text_align": "center",
        "vertical_align": "top",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left",
        "has_padding": true
      },
      "layout": {
        "x": 5,
        "y": 0,
        "width": 7,
        "height": 2
      }
    },
    {
      "id": 6980254194802650,
      "definition": {
        "title": "Nodes in scope of NLA [ For all users ]",
        "background_color": "purple",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 4781432084772944,
            "definition": {
              "type": "note",
              "content": "This group is to reveal the number of nodes in scope **overall**.\n\nIf you are interested by only a specific `condition`, select a value in the *conditions* filter and go to the dedicated group under this one.",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 1
            }
          },
          {
            "id": 4010116156560442,
            "definition": {
              "title": "Nodes in scope per condition",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 2386413699724848,
            "definition": {
              "title": "Top 100 NG in volume (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 3,
              "height": 5
            }
          },
          {
            "id": 8015477821795208,
            "definition": {
              "title": "Nodes out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7950668124204104,
            "definition": {
              "title": "Nodes in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 10,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 7246668633658838,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 1
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 7412384700206354,
            "definition": {
              "title": "Nodes in scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5961119455126678,
            "definition": {
              "title": "Nodes out of scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 4370952735358920,
            "definition": {
              "title": "Nodes out of scope per NG (Kafka out)",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,!nodegroup_name_prefix:,!nodegroup_name_prefix:kafka*,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 5677878745697302,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6640123274879848,
            "definition": {
              "title": "InScope ratio % per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 3,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 7387734748523948,
            "definition": {
              "title": "Nodes in scope per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 1000,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 5,
              "y": 5,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6840005046847554,
            "definition": {
              "title": "Top 50 NG in-scope  with condition(s)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 8,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 3771841520346786,
            "definition": {
              "title": "Top 50 NG out-scope with condition(s)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 10,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 2636504654169244,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 2,
        "width": 12,
        "height": 9
      }
    },
    {
      "id": 1052010918153610,
      "definition": {
        "title": "Conditions and Draining [ For all users ]",
        "background_color": "purple",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 433946539825520,
            "definition": {
              "title": "Node in scope per condition",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,!conditions:any,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 9,
              "height": 2
            }
          },
          {
            "id": 6427751319706432,
            "definition": {
              "title": "Velocity: nodes per hour",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "velocity",
                      "formula": "autosmooth(diff(query1))"
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,!conditions:any,$kube_cluster_name}.rollup(avg, 3600)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                },
                {
                  "on_right_yaxis": true,
                  "formulas": [
                    {
                      "alias": "unneeded-nodes",
                      "formula": "query0"
                    }
                  ],
                  "queries": [
                    {
                      "data_source": "metrics",
                      "name": "query0",
                      "query": "max:cluster_autoscaler.cluster_autoscaler_unneeded_nodes_count{$datacenter,$kube_cluster_name}"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "warm",
                    "line_type": "dashed",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                },
                {
                  "formulas": [
                    {
                      "formula": "query0"
                    }
                  ],
                  "queries": [
                    {
                      "data_source": "metrics",
                      "name": "query0",
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 3194424455027336,
            "definition": {
              "title": "Node count evolution per condition over 1 hour",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1h"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "hour_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 700665077320356,
            "definition": {
              "type": "note",
              "content": "If a node is drain and have 2 conditions, it is reported 2 times in the following tables.",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 2,
              "y": 2,
              "width": 1,
              "height": 4
            }
          },
          {
            "id": 2070958640848960,
            "definition": {
              "title": "Drained nodes",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "alias": "DrainSuccess"
                    },
                    {
                      "formula": "-query2",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "alias": "DrainFailure"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 3,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5580815046311712,
            "definition": {
              "title": "Drained nodes by Group",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "DrainSuccess",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "DrainFailure",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "formula": "-query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name} by {nodegroup_namespace,nodegroup_name,datacenter,team,conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name} by {nodegroup_namespace,nodegroup_name,datacenter,team,conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 5,
              "y": 2,
              "width": 4,
              "height": 8
            }
          },
          {
            "id": 8656267641824312,
            "definition": {
              "title": "% nodes in scope remaining for each condition (top right corner is bad)",
              "type": "scatterplot",
              "requests": {
                "table": {
                  "formulas": [
                    {
                      "alias": "Number of nodes",
                      "dimension": "x",
                      "formula": "query1"
                    },
                    {
                      "alias": "% in scope",
                      "dimension": "y",
                      "formula": "100 * query2 / (query2 + query3)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$conditions,!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$conditions,!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$conditions,!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              },
              "xaxis": {},
              "yaxis": {},
              "color_by_groups": [
                "kubernetes_cluster"
              ]
            },
            "layout": {
              "x": 9,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4856084336230616,
            "definition": {
              "type": "note",
              "content": "This plot will reveal number of nodes in scope for a given conditions that should be processed.\n\nThe top right corner quadrant is clearly a bad spot, it means that we have a lot of nodes that are in scope but not processed ",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 11,
              "y": 2,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5277037612287552,
            "definition": {
              "title": "Node count evolution per condition over 1 day",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name,in_scope:true} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4487612368015586,
            "definition": {
              "title": "Drained nodes by cluster",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "DrainSuccess",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "DrainFailure",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "formula": "-query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 3,
              "y": 4,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4429630895697708,
            "definition": {
              "title": "Nodes drained per conditions",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 4,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7698538653185660,
            "definition": {
              "title": "Node count evolution per condition over 1 week",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1w"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8842128848359704,
            "definition": {
              "type": "note",
              "content": "Green means that the we have less nodes with that condition.\n\nMore node with the signal have been replaced that added.\n\n\nRed means that more nodes have the condition than before. That does not mean that the drain is not working; it could be working but more nodes with the signal have appeared in the meantime.",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 2,
              "y": 6,
              "width": 1,
              "height": 4
            }
          },
          {
            "id": 1475196477102174,
            "definition": {
              "title": "Node waiting to be processed per cluster (in-scope node only) - includes all drain state (sheduled, completed, failed)",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "default_zero(query1 - query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,!conditions:any,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:kubernetes_state.nodes.by_condition{condition:drainscheduled,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 6,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 2053178047233004,
            "definition": {
              "title": "Drained nodes by conditions",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "alias": "DrainSuccess"
                    },
                    {
                      "formula": "-query2",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "alias": "DrainFailure"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {conditions}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {conditions}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 3,
              "y": 7,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 5228665601929604,
            "definition": {
              "title": "Node count evolution per condition over 1 month",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1mo"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "month_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 8,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3183882477099196,
            "definition": {
              "type": "note",
              "content": "Drain Status for node actually handled by draino",
              "background_color": "purple",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 10,
              "width": 12,
              "height": 1
            }
          },
          {
            "id": 5574027059702822,
            "definition": {
              "title": "Candidate Evaluation Pipeline",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Open Slots",
                      "conditional_formats": [],
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    },
                    {
                      "alias": "Total Nodes",
                      "conditional_formats": [],
                      "cell_display_mode": "number",
                      "formula": "query2"
                    },
                    {
                      "alias": "Filtered Out",
                      "conditional_formats": [],
                      "cell_display_mode": "number",
                      "formula": "query3"
                    },
                    {
                      "alias": "Simulation Rejection",
                      "conditional_formats": [],
                      "cell_display_mode": "number",
                      "formula": "query4"
                    },
                    {
                      "alias": "Rate limited",
                      "conditional_formats": [],
                      "cell_display_mode": "number",
                      "formula": "query5"
                    },
                    {
                      "alias": "Possible Candidates",
                      "conditional_formats": [
                        {
                          "palette": "white_on_green",
                          "value": 0,
                          "comparator": "<="
                        },
                        {
                          "palette": "white_on_red",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "formula": "(query2 - query3 - query4 - query5) * query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "max:draino.candidate_runner_remaining_slots{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "max:draino.candidate_runner_total_nodes{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "max:draino.candidate_runner_filtered_out_nodes{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    },
                    {
                      "query": "max:draino.candidate_runner_simulation_rejections{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query4",
                      "aggregator": "last"
                    },
                    {
                      "query": "max:draino.candidate_runner_condition_rate_limited{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query5",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 0,
              "y": 11,
              "width": 9,
              "height": 4
            }
          },
          {
            "id": 5282842584393476,
            "definition": {
              "title": "Node being process by drain - distribution in status (Scheduled|Completed|Failed)",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query2"
                    },
                    {
                      "formula": "query3"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,!conditions:any,drain_status:completed,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,!conditions:any,drain_status:scheduled,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query"
                    },
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,!conditions:any,drain_status:error,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,!conditions:any,drain_status:failed,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 11,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 11,
        "width": 12,
        "height": 16
      }
    },
    {
      "id": 7708500101102508,
      "definition": {
        "title": "Nodes in scope of NLA a specific condition [ For Maintainers ]  -->  MUST SELECT A SPECIF CONDITION IN FILTERS ",
        "background_color": "gray",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3643951807334258,
            "definition": {
              "type": "note",
              "content": "!!! This group is to relevant only if the filter `condition` is set to a specific value !!!",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 5,
              "height": 1
            }
          },
          {
            "id": 5875761948972562,
            "definition": {
              "type": "note",
              "content": "",
              "background_color": "gray",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 1,
              "height": 11
            }
          },
          {
            "id": 5991858968515354,
            "definition": {
              "type": "note",
              "content": "This group give some more details per conditions compare to first group\n\nText Filter in table applies only on the Top elements --> use the template at the top of the page for a correct filtering",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 6,
              "height": 1
            }
          },
          {
            "id": 3267953693262066,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 6403527805331178,
            "definition": {
              "title": "Nodes in scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1284097298691016,
            "definition": {
              "title": "Nodes out of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:false,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 8217124501354294,
            "definition": {
              "title": "Node in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 1,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 4233355766100192,
            "definition": {
              "title": "Top 50  conditions for a given cluster: in-scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions,kube_cluster_name,datacenter}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 6,
              "y": 1,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 7633829703152656,
            "definition": {
              "title": "Top 50  conditions for a given cluster: out-scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 9,
              "y": 1,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6254526932764740,
            "definition": {
              "title": "InScope ratio % per cluster (0% do not appear)",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 50,
                        "order": "asc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 4573318362139322,
            "definition": {
              "title": "Top 100 NG with condition(s) (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 6,
              "y": 4,
              "width": 6,
              "height": 7
            }
          },
          {
            "id": 7467676018451562,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:false,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6525072437002530,
            "definition": {
              "title": "Node out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:false,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 6,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 1277966241156488,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 9,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 27,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 5485166690364998,
      "definition": {
        "title": "Cordon activity [ For maintainers ]",
        "background_color": "blue",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 2280824799812764,
            "definition": {
              "type": "note",
              "content": "Clusters and NG that stay at their cordon limit for a long period reflects the fact that NLA cannot progress on that cluster or nodegroup.\n\nIt worth checking if we are not in one of the following case:\n- many node block with drain failed\n- cluster-autoscaler can't scale-down empty nodes\n- - MinSize>1 on the NG\n- - CA in cool-down or scaleup loop or not working\n- users have manually cordon many nodes\n- too many notReady nodes\n- too many pending pods",
              "background_color": "orange",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "25%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 3
            }
          },
          {
            "id": 7803499812443874,
            "definition": {
              "title": "Global block at Cluster level: Too much NotReadyNodes or too much Pending pods",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "min:draino.draino_global_block{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {block,kube_cluster_name}.rollup(min, 180)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": "any cluster appearing here is blocked for any Node Lifecycle Activity. Check the name of the blocker by moving the mouse on the bar.",
                  "value": "y = 0",
                  "display_type": "error dashed"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 4,
              "height": 3
            }
          },
          {
            "id": 717237193483322,
            "definition": {
              "title": "Count of nodes being cordon by `draino`  per cluster",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,!drain_status:none,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "purple",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": "MaxCordon=25 for stateless application",
                  "value": "y = 25",
                  "display_type": "error bold"
                },
                {
                  "label": "MaxCordon=40 for stateful application",
                  "value": "y = 40",
                  "display_type": "error bold"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 3
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 28,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 5309358840670748,
      "definition": {
        "title": "Drain failures [ For maintainers ]",
        "background_color": "orange",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 8782049468167624,
            "definition": {
              "title": "Drain failure cause evolution over 1 week",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1w"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "show_present": false,
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "relative"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 281988546734666,
            "definition": {
              "title": "Top drain failure cause",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8182803832166418,
            "definition": {
              "title": "Top drain failure per NG",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2556704129298930,
            "definition": {
              "title": "Top drain failure per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5815134629560906,
            "definition": {
              "title": "Node drain failures and causes",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 8849723189291790,
            "definition": {
              "title": "Drain failure cause evolution over 1 day",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "show_present": false,
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "relative"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8585872723575556,
            "definition": {
              "title": "Drain failure cause evolution over selected timerange",
              "title_size": "16",
              "title_align": "left",
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "show_present": false,
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "relative"
                }
              ]
            },
            "layout": {
              "x": 2,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5320765848923344,
            "definition": {
              "type": "note",
              "content": "Permanent failures represents node for which automatic retry has failed more that 7 times.\nThe system then give up.\nThe node is uncordon and it is annotated with:\n`draino/drain-retry-failed: failed`\n\n[link to list of nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23draino%2Fdrain-retry-failed%3Afailed&paused=false)\n\nTo purge the NLA history on that node and restart a complete cycle from the beginning change the value of the annotation:\n`draino/drain-retry-failed: restart`",
              "background_color": "vivid_orange",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "25%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 4,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3273617787035484,
            "definition": {
              "title": "Permanent failure",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,drain_retry_failed:true,conditions:any,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7622677039443004,
            "definition": {
              "title": "Permanent failure",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,drain_retry_failed:true,conditions:any,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 29,
        "width": 12,
        "height": 1,
        "is_column_break": true
      }
    },
    {
      "id": 4709611263760734,
      "definition": {
        "title": "Feature: preprovisioning",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5980217962865516,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23node-lifecycle.datadoghq.com%2Fprovision-new-node-before-drain%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 1464465413262190,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 3884288874956624,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6918473263694964,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2157215042598504,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6152241964374510,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,preprovisioning:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 2870777055911904,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 3407299307600446,
            "definition": {
              "title": "Number of nodes OUT of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 30,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 8582675326216548,
      "definition": {
        "title": "Feature: pvc management",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3357326972004282,
            "definition": {
              "type": "note",
              "content": "link to [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=annotation%23draino%2Fdelete-pvc-and-pv%3Atrue&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=annotation%23draino%2Fdelete-pvc-and-pv%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 6101614011237702,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1803839147126590,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7974928941284808,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5998155848479010,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2783372916178758,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,pvc_management:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 4514195184299708,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,in_scope:true*,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1377123385895790,
            "definition": {
              "title": "Number of nodes OUT of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,pvc_management:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 31,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 5551490132657834,
      "definition": {
        "title": "Feature: drain retry",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 6048291701448336,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23draino%2Fdrain-retry%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 8176313131797116,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 2238493323351402,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8907444524023096,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8497813126918522,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 483456555713558,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,drain_retry:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 4873969492474464,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1245244384400038,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,drain_retry:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 32,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 1539097608731504,
      "definition": {
        "title": "Feature: eviction++ url",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1812038611998916,
            "definition": {
              "type": "note",
              "content": "link to [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=annotation%23draino%2Feviction-api-url%3A%2A&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=annotation%23draino%2Feviction-api-url%3A%2A&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 7975169297458104,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 6846336810364662,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5350201804727372,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5744437128299896,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4026412961817574,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,eviction_url:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 8692133250777212,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1350140128036796,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,eviction_url:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 33,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 7537549973247164,
      "definition": {
        "title": "Feature: user opt-out",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 8540343693386668,
            "definition": {
              "type": "note",
              "content": "link to [nodes](https://app.datadoghq.com/orchestration/overview/node?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) [deployment](https://app.datadoghq.com/orchestration/overview/deployment?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 4571618321899692,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1187743876967728,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8472352685346132,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6117333180622830,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3715951164067492,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,user_opt_out_via_pod_annotation:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 539437336994560,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 8228191989677458,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_out_via_pod_annotation:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 34,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 3917229782842188,
      "definition": {
        "title": "Feature: user specific condition",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3632045483726858,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=tag%23draino%2Fnode-conditions%3A%2A&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 5316051024805018,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "(100 * query1) / query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 3086206552562880,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3434543215242242,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5436036677808686,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8115140040734690,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,$ng_namespace,$ng_name,$team,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7367789757762526,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,in_scope:true,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 763536452837436,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,in_scope:false,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 35,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 6161816318816972,
      "definition": {
        "title": "Feature: user opt-in",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1421312419550774,
            "definition": {
              "type": "note",
              "content": "link to [nodes](https://app.datadoghq.com/orchestration/overview/node?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) [deployment](https://app.datadoghq.com/orchestration/overview/deployment?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 2734235425777792,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 8464380871895574,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 847250637726096,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5200793595908224,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7806640292704436,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,$datacenter,user_opt_in_via_pod_annotation:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 1188197115636516,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 2299075389880718,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,user_opt_in_via_pod_annotation:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 36,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 326392034245612,
      "definition": {
        "title": "Feature: block eviction",
        "background_color": "vivid_green",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 4610684755086312,
            "definition": {
              "type": "note",
              "content": "link to [nodes](/orchestration/overview/node?query=annotation%23node-lifecycle.datadoghq.com%2Fblock-eviction-for-username%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fblock-eviction-for-group%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fallow-eviction-only-for-username%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fallow-eviction-only-for-group%3A%2A&expanded=tag%23nodegroups.datadoghq.com%2Fnamespace%3Aandy&groups=tag%23nodegroups.datadoghq.com%2Fnamespace&paused=true) and [pods](/orchestration/overview/pod?query=annotation%23node-lifecycle.datadoghq.com%2Fblock-eviction-for-username%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fblock-eviction-for-group%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fallow-eviction-only-for-username%3A%2A%20OR%20annotation%23node-lifecycle.datadoghq.com%2Fallow-eviction-only-for-group%3A%2A&expanded=tag%23kube_namespace%3Aandy&groups=tag%23kube_namespace&paused=true)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1848068169024616,
            "definition": {
              "title": "Namespaces with most blocked evictions",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:disruption_budget_manager.admission_eviction_blocked_annotation_count{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {namespace}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 1,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 821370920893742,
            "definition": {
              "title": "Clusters with most blocked evictions",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:disruption_budget_manager.admission_eviction_blocked_annotation_count{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3376187941162004,
            "definition": {
              "title": "Blocked evictions over time by cluster",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:disruption_budget_manager.admission_eviction_blocked_annotation_count{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6356036232129158,
            "definition": {
              "title": "Evolution of blocked evictions",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:disruption_budget_manager.admission_eviction_blocked_annotation_count{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 37,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 4077740151293666,
      "definition": {
        "title": "CPU in scope of NLA [ For all users ]",
        "background_color": "purple",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5801848886462402,
            "definition": {
              "type": "note",
              "content": "This group is to reveal the number of nodes in scope **overall**.\n\nIf you are interested by only a specific `condition`, select a value in the *conditions* filter and go to the dedicated group under this one.",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 1
            }
          },
          {
            "id": 1734945488969672,
            "definition": {
              "title": "CPUs in scope per condition",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4611597749074084,
            "definition": {
              "title": "Top 100 NG in CPU count (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 3,
              "height": 5
            }
          },
          {
            "id": 4198682471884760,
            "definition": {
              "title": "CPUs in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 1200173675326860,
            "definition": {
              "title": "CPUs out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 10,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 4087938201264562,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5952012919660484,
            "definition": {
              "title": "CPUs in scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "CPUs",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 2430778181213064,
            "definition": {
              "title": "CPUs out of scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "CPU",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 7885350626683318,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 487199249592496,
            "definition": {
              "title": "InScope ratio % per cluster1",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 3,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 2730714035803450,
            "definition": {
              "title": "CPUs in scope per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 1000,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 5,
              "y": 5,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6611737061864436,
            "definition": {
              "title": "Top 50 NG in-scope  with condition(s) in CPU count",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 8,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4556362726140242,
            "definition": {
              "title": "Top 50 NG out-scope with condition(s) in CPU count",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 10,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 3055409049932458,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 38,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 1406336625253506,
      "definition": {
        "title": "Nodes status",
        "background_color": "vivid_yellow",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 483215088732880,
            "definition": {
              "title": "Node lifetime - Cluster Average",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "forecast(query1, 'linear', 1)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime_hours{$datacenter,$ng_namespace,$ng_name,$kube_cluster_name} by {kubernetes_cluster,datacenter}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                },
                {
                  "formulas": [
                    {
                      "formula": "forecast(query1, \"linear\", 1)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime{$datacenter,$ng_namespace,*,$ng_name,$kube_cluster_name} by {kubernetes_cluster,datacenter}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " 90 Days ",
                  "value": "y = 2160",
                  "display_type": "error dashed"
                },
                {
                  "label": " 30 Days ",
                  "value": "y = 720",
                  "display_type": "warning dashed"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 1363728755141114,
            "definition": {
              "title": "Node lifetime - Team Average",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node Lifetime average",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      },
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kubernetes_cluster,datacenter,team}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7991587368828250,
            "definition": {
              "title": "",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:k8s_node_metadata_controller.node_out_of_date{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5180322712433436,
            "definition": {
              "title": "",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:k8s_node_metadata_controller.node_out_of_date{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kube_cluster_name,nodegroups.datadoghq.com/name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 39,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 1350557661640550,
      "definition": {
        "title": "Zonal Clusters",
        "background_color": "vivid_blue",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 6762822465645054,
            "definition": {
              "title": "Zonal clusters: partition open for eviction",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "max:disruption_budget_manager.time_partition{reason:,$datacenter,$kube_cluster_name} by {partition,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 40,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 2736361423609622,
      "definition": {
        "title": "Overdue in scope",
        "background_color": "vivid_purple",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 7771272165561650,
            "definition": {
              "type": "note",
              "content": "Nodes are **counted multiple times** if they have multiple conditions, and multiple or all conditions are selected. The typical use case for this section is to select the special tag `condition:any` or a single condition, e.g., `condition:cluster-upgrade`.",
              "background_color": "yellow",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 4583792256201318,
            "definition": {
              "title": "Overdue nodes in scope",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {datacenter,kube_cluster_name,nodegroup_namespace,nodegroup_name,conditions}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 8653562303329990,
            "definition": {
              "title": "Overdue nodes in scope",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 6602757960915194,
            "definition": {
              "title": "Overdue nodes in scope vs. a week before",
              "title_size": "16",
              "title_align": "left",
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "increase_good": false,
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 2000338419773100,
            "definition": {
              "title": "Overdue nodes in scope vs. a week before",
              "title_size": "16",
              "title_align": "left",
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "increase_good": false,
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "order_dir": "desc",
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 2,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 5692977420628706,
            "definition": {
              "title": "Overdue nodes in scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$team,conditions:any}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1 / query2 * 100"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 41,
        "width": 12,
        "height": 5
      }
    },
    {
      "id": 6865025737497832,
      "definition": {
        "title": "Overdue out of scope",
        "background_color": "vivid_purple",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 7039959996452188,
            "definition": {
              "type": "note",
              "content": "Nodes are **counted multiple times** if they have multiple conditions, and multiple or all conditions are selected. The typical use case for this section is to select the special tag `condition:any` or a single condition, e.g., `condition:cluster-upgrade`.",
              "background_color": "yellow",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 7709959230389116,
            "definition": {
              "title": "Overdue nodes out of scope",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {datacenter,kube_cluster_name,nodegroup_namespace,nodegroup_name,conditions}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 5685056207646236,
            "definition": {
              "title": "Overdue nodes out of scope",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 3305694605675192,
            "definition": {
              "title": "Overdue nodes out of scope vs. a week before",
              "title_size": "16",
              "title_align": "left",
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 5736207918976964,
            "definition": {
              "title": "Overdue nodes out of scope vs. a week before",
              "title_size": "16",
              "title_align": "left",
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team} by {nodegroup_name,nodegroup_namespace,kube_cluster_name,datacenter,conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 2,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 7035180830175418,
            "definition": {
              "title": "Overdue nodes out of scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,overdue:true,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$conditions,$team}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,$team,conditions:any}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1 / query2 * 100"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 46,
        "width": 12,
        "height": 5
      }
    },
    {
      "id": 8685605812508832,
      "definition": {
        "title": "Filters",
        "show_title": true,
        "type": "group",
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 8823592594630030,
            "definition": {
              "title": "Nodes without conditions",
              "title_size": "16",
              "title_align": "left",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "name": "query1",
                      "data_source": "metrics",
                      "query": "sum:draino.filters_node_filters{filter:conditions,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name}",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ]
                }
              ],
              "autoscale": true,
              "precision": 2,
              "timeseries_background": {
                "type": "area",
                "yaxis": {
                  "include_zero": true
                }
              }
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 1129444372685476,
            "definition": {
              "title": "Most applied filters",
              "title_size": "16",
              "title_align": "left",
              "requests": [
                {
                  "response_format": "scalar",
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "order": "desc"
                      }
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{!filter:conditions,$datacenter,$kube_cluster_name,$ng_namespace,$ng_name} by {filter}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "style": {
                    "palette": "datadog16"
                  }
                }
              ],
              "type": "sunburst",
              "legend": {
                "type": "automatic"
              }
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 7329791191232438,
            "definition": {
              "title": "Global Blocker",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,filter:globalblocker} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "style": {
                    "palette": "red"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 7402016904539362,
            "definition": {
              "title": "Node replacement failure",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,filter:node_replacement_failed} by {kube_cluster_name,nodegroup_namespace,nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "red"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 101062896318698,
            "definition": {
              "title": "PVC Bound",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,filter:pvcbound} by {kube_cluster_name,nodegroup_namespace,nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "red"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 861507909407618,
            "definition": {
              "title": "Waiting for retry",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,filter:retry} by {kube_cluster_name,nodegroup_namespace,nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "grey"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 10,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 5643031040501790,
            "definition": {
              "title": "Opted out, by pods or node labels",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter AND $kube_cluster_name AND $ng_namespace AND $ng_name AND (filter:labels OR filter:pods)} by {nodegroup_namespace,nodegroup_name,group_key,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ],
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 4,
              "height": 3
            }
          },
          {
            "id": 4877274013744356,
            "definition": {
              "title": "Drain buffer not expired",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "query": "sum:draino.filters_node_filters{$datacenter,$kube_cluster_name,$ng_namespace,$ng_name,filter:drain_buffer} by {nodegroup_namespace,nodegroup_name,group_key,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "purple"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 3,
              "width": 4,
              "height": 3
            }
          },
          {
            "id": 3183808674068820,
            "definition": {
              "title": "Rate limiting",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "queries": [
                    {
                      "query": "max:draino.candidate_runner_condition_rate_limited{$datacenter,$kube_cluster_name} by {kube_cluster_name,group_key}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "style": {
                    "palette": "orange"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 3,
              "width": 4,
              "height": 3
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 51,
        "width": 12,
        "height": 7
      }
    },
    {
      "id": 7346537152821274,
      "definition": {
        "title": "Nodes drained and CA scaleup/down",
        "show_legend": false,
        "legend_layout": "auto",
        "legend_columns": [
          "avg",
          "min",
          "max",
          "value",
          "sum"
        ],
        "type": "timeseries",
        "requests": [
          {
            "formulas": [
              {
                "formula": "query1"
              }
            ],
            "response_format": "timeseries",
            "on_right_yaxis": false,
            "queries": [
              {
                "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name,datacenter}.rollup(sum)",
                "data_source": "metrics",
                "name": "query1"
              }
            ],
            "style": {
              "palette": "green",
              "line_type": "solid",
              "line_width": "normal"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "formula": "query1"
              }
            ],
            "response_format": "timeseries",
            "on_right_yaxis": false,
            "queries": [
              {
                "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name,datacenter}.rollup(sum)",
                "data_source": "metrics",
                "name": "query1"
              }
            ],
            "style": {
              "palette": "red",
              "line_type": "solid",
              "line_width": "normal"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "on_right_yaxis": true,
            "queries": [
              {
                "query": "sum:cluster_autoscaler.cluster_autoscaler_scaled_up_nodes_total{$datacenter,$kube_cluster_name} by {datacenter,kube_cluster_name}.as_count()",
                "data_source": "metrics",
                "name": "query0"
              }
            ],
            "style": {
              "palette": "blue",
              "line_type": "solid",
              "line_width": "normal"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "on_right_yaxis": true,
            "queries": [
              {
                "query": "sum:cluster_autoscaler.cluster_autoscaler_scaled_down_nodes_total{$datacenter,$kube_cluster_name} by {datacenter,kube_cluster_name}.as_count()",
                "data_source": "metrics",
                "name": "query0"
              }
            ],
            "style": {
              "palette": "grey",
              "line_type": "solid",
              "line_width": "normal"
            },
            "display_type": "bars"
          }
        ],
        "yaxis": {
          "include_zero": true,
          "scale": "linear",
          "label": "",
          "min": "auto",
          "max": "auto"
        },
        "markers": []
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 3,
        "height": 3
      }
    },
    {
      "id": 2936962659417460,
      "definition": {
        "title": "Start of draino and leader election lost",
        "title_size": "16",
        "title_align": "left",
        "show_legend": false,
        "legend_layout": "auto",
        "legend_columns": [
          "avg",
          "min",
          "max",
          "value",
          "sum"
        ],
        "type": "timeseries",
        "requests": [
          {
            "formulas": [
              {
                "alias": "Restart",
                "formula": "query2"
              }
            ],
            "queries": [
              {
                "data_source": "logs",
                "name": "query2",
                "search": {
                  "query": "service:draino \"starting Manager\" $datacenter $kube_cluster_name"
                },
                "indexes": [
                  "*"
                ],
                "compute": {
                  "aggregation": "count"
                },
                "group_by": [
                  {
                    "facet": "kube_cluster_name",
                    "limit": 10,
                    "sort": {
                      "aggregation": "count",
                      "order": "desc"
                    }
                  }
                ],
                "storage": "hot"
              }
            ],
            "response_format": "timeseries",
            "style": {
              "palette": "dog_classic"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "alias": "Leader Election",
                "style": {
                  "palette_index": 2,
                  "palette": "warm"
                },
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "queries": [
              {
                "search": {
                  "query": "service:draino \"panic: lost leader election [recovered]\" $datacenter $kube_cluster_name"
                },
                "data_source": "logs",
                "compute": {
                  "aggregation": "count"
                },
                "name": "query0",
                "storage": "hot",
                "indexes": [
                  "*"
                ],
                "group_by": []
              }
            ],
            "style": {
              "palette": "orange"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "alias": "OOM",
                "style": {
                  "palette_index": 5,
                  "palette": "warm"
                },
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "queries": [
              {
                "search": {
                  "query": "service:kernel \"draino invoked oom-killer\" $datacenter $kube_cluster_name"
                },
                "data_source": "logs",
                "compute": {
                  "aggregation": "count"
                },
                "name": "query0",
                "storage": "hot",
                "indexes": [
                  "*"
                ],
                "group_by": []
              }
            ],
            "style": {
              "palette": "red"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "alias": "Pod Reschedule",
                "style": {
                  "palette_index": 5,
                  "palette": "green"
                },
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "queries": [
              {
                "search": {
                  "query": "@objectRef.name:draino* @http.method:create @objectRef.resource:pods @objectRef.subresource:binding $datacenter $kube_cluster_name"
                },
                "data_source": "logs",
                "compute": {
                  "aggregation": "count"
                },
                "name": "query0",
                "storage": "hot",
                "indexes": [
                  "k8s-audit"
                ],
                "group_by": []
              }
            ],
            "style": {
              "palette": "dog_classic"
            },
            "display_type": "bars"
          },
          {
            "formulas": [
              {
                "alias": "Fatal Error",
                "style": {
                  "palette_index": 4,
                  "palette": "gray"
                },
                "formula": "-query0"
              }
            ],
            "response_format": "timeseries",
            "queries": [
              {
                "search": {
                  "query": "service:draino $kube_cluster_name $datacenter \"fatal error\""
                },
                "data_source": "logs",
                "compute": {
                  "aggregation": "count"
                },
                "name": "query0",
                "storage": "hot",
                "indexes": [
                  "*"
                ],
                "group_by": []
              }
            ],
            "style": {
              "palette": "dog_classic",
              "line_type": "solid",
              "line_width": "normal"
            },
            "display_type": "bars"
          }
        ]
      },
      "layout": {
        "x": 3,
        "y": 0,
        "width": 4,
        "height": 3
      }
    },
    {
      "id": 3406469269386385,
      "definition": {
        "title": "Nodes with too many retries",
        "title_size": "16",
        "title_align": "left",
        "requests": [
          {
            "response_format": "event_list",
            "query": {
              "data_source": "logs_pattern_stream",
              "query_string": "service:draino message:\"retry wall is hitting limit for node\" $datacenter $kube_cluster_name",
              "indexes": [],
              "group_by": [
                {
                  "facet": "kube_cluster_name"
                },
                {
                  "facet": "@node"
                }
              ]
            },
            "columns": [
              {
                "field": "status_line",
                "width": "auto"
              },
              {
                "field": "volume",
                "width": "auto"
              },
              {
                "field": "kube_cluster_name",
                "width": "auto"
              },
              {
                "field": "@node",
                "width": "auto"
              }
            ]
          }
        ],
        "type": "list_stream"
      },
      "layout": {
        "x": 0,
        "y": 3,
        "width": 7,
        "height": 3
      }
    },
    {
      "id": 1962756307395134,
      "definition": {
        "title": "Distribution of out of scope nodes",
        "type": "scatterplot",
        "requests": {
          "table": {
            "response_format": "scalar",
            "formulas": [
              {
                "dimension": "x",
                "alias": "cluster node count",
                "formula": "query2"
              },
              {
                "dimension": "radius",
                "alias": "out of scope count",
                "formula": "query3"
              },
              {
                "alias": "in scope %",
                "dimension": "y",
                "formula": "100 * query1 / (query2)"
              }
            ],
            "queries": [
              {
                "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name,kube_cluster_name:*} by {kube_cluster_name}",
                "data_source": "metrics",
                "name": "query2",
                "aggregator": "last"
              },
              {
                "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name,in_scope:false,kube_cluster_name:*} by {kube_cluster_name}",
                "data_source": "metrics",
                "name": "query3",
                "aggregator": "last"
              },
              {
                "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name,$conditions,kube_cluster_name:*} by {kube_cluster_name}",
                "data_source": "metrics",
                "name": "query1",
                "aggregator": "last"
              }
            ]
          }
        },
        "color_by_groups": []
      },
      "layout": {
        "x": 0,
        "y": 6,
        "width": 12,
        "height": 3
      }
    }
  ],
  "template_variables": [
    {
      "name": "datacenter",
      "prefix": "datacenter",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "kube_cluster_name",
      "prefix": "kube_cluster_name",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "ng_namespace",
      "prefix": "nodegroup_namespace",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "ng_name",
      "prefix": "nodegroup_name",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "team",
      "prefix": "team",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "conditions",
      "prefix": "conditions",
      "available_values": [],
      "default": "*"
    }
  ],
  "layout_type": "ordered",
  "notify_list": [],
  "reflow_type": "fixed",
  "tags": [
    "team:compute"
  ],
  "id": "84p-xk3-aga"
}

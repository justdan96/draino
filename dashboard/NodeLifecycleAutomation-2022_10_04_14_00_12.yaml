{
  "title": "[compute] [nla] Node Lifecycle Automation",
  "description": "## Node Life Cycle Automation\n[Documentation](https://infra-docs.us1.prod.dog/kubernetes/kubernetes/node-lifecycle/)\n## Related Dashboards\n[Dashboard list](https://app.datadoghq.com/dashboard/lists?q=%5Bcompute%5D+%5Bnla%5D)\n## Contact\n[Slack](https://dd.slack.com/archives/C010UB763NE)\n\n## Logs query\n[my pod](https://app.datadoghq.com/logs?query=%40objectRef.resource%3A%28events%20OR%20pods%29%20%28%40requestObject.involvedObject.name%3ApodName%20OR%20%40objectRef.name%3ApodName%29%20-%40http.method%3Aget%20-%40objectRef.subresource%3Aeviction&cols=kubernetes_cluster%2C%40requestObject.metadata.namespace%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true) : replace {podName} by the real value in the logs query.\n\n@david.benque",
  "widgets": [
    {
      "id": 4647566357591622,
      "definition": {
        "type": "note",
        "content": "\n[Documentation](https://datadoghq.atlassian.net/wiki/spaces/K8S/pages/2274623742/NLA+-+Node+Lifecycle+Automation) | [FAQ](https://datadoghq.atlassian.net/wiki/spaces/K8S/pages/2277966820/NLA+-+FAQ) |\n[Dashboard list](https://app.datadoghq.com/dashboard/lists?q=%5Bcompute%5D+%5Bnla%5D) | [Slack](https://dd.slack.com/archives/C010UB763NE)\n",
        "background_color": "white",
        "font_size": "24",
        "text_align": "center",
        "vertical_align": "top",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left",
        "has_padding": true
      },
      "layout": {
        "x": 0,
        "y": 0,
        "width": 5,
        "height": 2
      }
    },
    {
      "id": 5302483934625036,
      "definition": {
        "type": "note",
        "content": "Audit logs for **[my pod](https://app.datadoghq.com/logs?query=%40objectRef.resource%3A%28events%20OR%20pods%29%20%28%40requestObject.involvedObject.name%3ApodName%20OR%20%40objectRef.name%3ApodName%29%20%40requestObject.source.component%3Adraino&cols=kubernetes_cluster%2C%40requestObject.metadata.namespace%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true)** , **[my node](https://app.datadoghq.com/logs?query=%40objectRef.resource%3A%28events%20OR%20nodes%29%20%28%40requestObject.involvedObject.name%3AnodeName%20OR%20%40objectRef.name%3AnodeName%29%20-%40http.method%3A%28get%20OR%20watch%29%20%40requestObject.source.component%3Adraino&cols=kubernetes_cluster%2C%40requestObject.source.component%2C%40http.method%2C%40objectRef.name%2C%40requestObject.spec.unschedulable%2C%40requestObject.reason%2C%40requestObject.message&index=k8s-audit&messageDisplay=inline&stream_sort=time%2Casc&live=true)** and [evictions](https://app.datadoghq.com/logs?query=%40usr.name%3A%22system%3Aserviceaccount%3Acluster-controllers%3Adraino%22%20%20%40requestObject.reason%3A%28Evictio%2A%20OR%20Cordo%2A%20OR%20Uncord%2A%20OR%20Drain%2A%29&agg_m=count&agg_q=%40requestObject.involvedObject.name&agg_t=count&cols=kubernetes_cluster%2C%40requestObject.involvedObject.kind%2C%40objectRef.name%2C%40requestObject.reason%2C%40requestObject.message%2C%40requestObject.involvedObject.name&index=k8s-audit&messageDisplay=inline&sort_m=&sort_t=&stream_sort=time%2Cdesc&top_n=10&top_o=top&viz=stream&from_ts=1637942472685&to_ts=1637946072685&live=true)\n\nreplace {podName|nodeName} by the real value in the logs query + set time window\n\n\n\n",
        "background_color": "white",
        "font_size": "16",
        "text_align": "center",
        "vertical_align": "top",
        "show_tick": false,
        "tick_pos": "50%",
        "tick_edge": "left",
        "has_padding": true
      },
      "layout": {
        "x": 5,
        "y": 0,
        "width": 7,
        "height": 2
      }
    },
    {
      "id": 6980254194802650,
      "definition": {
        "title": "Nodes in scope of NLA [ For all users ]",
        "type": "group",
        "background_color": "purple",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 4781432084772944,
            "definition": {
              "type": "note",
              "content": "This group is to reveal the number of nodes in scope **overall**.\n\nIf you are interested by only a specific `condition`, select a value in the *conditions* filter and go to the dedicated group under this one.",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 1
            }
          },
          {
            "id": 4010116156560442,
            "definition": {
              "title": "Nodes in scope per condition",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 2386413699724848,
            "definition": {
              "title": "Top 100 NG in volume (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 3,
              "height": 5
            }
          },
          {
            "id": 8015477821795208,
            "definition": {
              "title": "Nodes out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 7950668124204104,
            "definition": {
              "title": "Nodes in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 10,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 7246668633658838,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 1
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 7412384700206354,
            "definition": {
              "title": "Nodes in scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5961119455126678,
            "definition": {
              "title": "Nodes out of scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5677878745697302,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6640123274879848,
            "definition": {
              "title": "InScope ratio % per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 3,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 7387734748523948,
            "definition": {
              "title": "Nodes in scope per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 1000,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 5,
              "y": 5,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6840005046847554,
            "definition": {
              "title": "Top 50 NG in-scope  with condition(s)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 8,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 3771841520346786,
            "definition": {
              "title": "Top 50 NG out-scope with condition(s)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 10,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 2636504654169244,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 2,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 1052010918153610,
      "definition": {
        "title": "Conditions and Draining [ For all users ]",
        "type": "group",
        "background_color": "purple",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 433946539825520,
            "definition": {
              "title": "Node in scope per condition",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,app:draino-standard,$conditions,!conditions:any,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 9,
              "height": 2
            }
          },
          {
            "id": 3997265518099924,
            "definition": {
              "title": "Velocity: nodes per hour",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "autosmooth(diff(query1))"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,app:draino-standard,$conditions,!conditions:any,$kube_cluster_name}.rollup(avg, 3600)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 3194424455027336,
            "definition": {
              "title": "Node count evolution per condition over 1 hour",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1h"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "hour_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 700665077320356,
            "definition": {
              "type": "note",
              "content": "If a node is drain and have 2 conditions, it is reported 2 times in the following tables.",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 2,
              "y": 2,
              "width": 1,
              "height": 4
            }
          },
          {
            "id": 2070958640848960,
            "definition": {
              "title": "Drained nodes",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "alias": "DrainSuccess"
                    },
                    {
                      "formula": "-query2",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "alias": "DrainFailure"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 3,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5580815046311712,
            "definition": {
              "title": "Drained nodes by Group",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "DrainSuccess",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "DrainFailure",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "formula": "-query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name} by {nodegroup_namespace,nodegroup_name,datacenter,team,conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$conditions,$ng_namespace,$team,$ng_name,$kube_cluster_name} by {nodegroup_namespace,nodegroup_name,datacenter,team,conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 5,
              "y": 2,
              "width": 4,
              "height": 8
            }
          },
          {
            "id": 8656267641824312,
            "definition": {
              "title": "% nodes in scope remaining for each condition (top right corner is bad)",
              "type": "scatterplot",
              "requests": {
                "table": {
                  "formulas": [
                    {
                      "alias": "Number of nodes",
                      "dimension": "x",
                      "formula": "query1"
                    },
                    {
                      "alias": "% in scope",
                      "dimension": "y",
                      "formula": "100 * query2 / (query2 + query3)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$conditions,!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,$conditions,!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$conditions,!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              },
              "xaxis": {},
              "yaxis": {},
              "color_by_groups": [
                "kubernetes_cluster"
              ]
            },
            "layout": {
              "x": 9,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4856084336230616,
            "definition": {
              "type": "note",
              "content": "This plot will reveal number of nodes in scope for a given conditions that should be processed.\n\nThe top right corner quadrant is clearly a bad spot, it means that we have a lot of nodes that are in scope but not processed ",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 11,
              "y": 2,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5277037612287552,
            "definition": {
              "title": "Node count evolution per condition over 1 day",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4487612368015586,
            "definition": {
              "title": "Drained nodes by cluster",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "DrainSuccess",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "DrainFailure",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "formula": "-query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 3,
              "y": 4,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4429630895697708,
            "definition": {
              "title": "Nodes drained per conditions",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions,kube_cluster_name}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 4,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7698538653185660,
            "definition": {
              "title": "Node count evolution per condition over 1 week",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1w"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8842128848359704,
            "definition": {
              "type": "note",
              "content": "Green means that the we have less nodes with that condition.\n\nMore node with the signal have been replaced that added.\n\n\nRed means that more nodes have the condition than before. That does not mean that the drain is not working; it could be working but more nodes with the signal have appeared in the meantime.",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 2,
              "y": 6,
              "width": 1,
              "height": 4
            }
          },
          {
            "id": 1815872098257958,
            "definition": {
              "title": "Nodes with drainScheduled (scheduled|completed|failed)",
              "show_legend": false,
              "legend_layout": "vertical",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query2"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:kubernetes_state.nodes.by_condition{condition:drainscheduled,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    },
                    {
                      "query": "sum:kubernetes_state.node.by_condition{condition:drainscheduled,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 6,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 2053178047233004,
            "definition": {
              "title": "Drained nodes by conditions",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_green",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "alias": "DrainSuccess"
                    },
                    {
                      "formula": "-query2",
                      "conditional_formats": [
                        {
                          "palette": "black_on_light_red",
                          "comparator": "<",
                          "value": 0
                        }
                      ],
                      "alias": "DrainFailure"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:succeeded,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {conditions}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    },
                    {
                      "query": "sum:draino.draino_drained_nodes_total{$datacenter,result:failed,$ng_namespace,$team,$ng_name,$conditions,$kube_cluster_name} by {conditions}.rollup(sum)",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "sum"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 3,
              "y": 7,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 5228665601929604,
            "definition": {
              "title": "Node count evolution per condition over 1 month",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1mo"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "month_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "change_type": "absolute",
                  "order_dir": "asc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{!conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "order_by": "change"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 8,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 1475196477102174,
            "definition": {
              "title": "Node waiting to be processed per cluster (in-scope node only) - includes all drain state (sheduled, completed, failed)",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1 - query2"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,in_scope:true,app:draino-standard,!conditions:any,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:kubernetes_state.nodes.by_condition{condition:drainscheduled,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 9,
              "y": 8,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 3183882477099196,
            "definition": {
              "type": "note",
              "content": "Drain Status for node actually handled by draino",
              "background_color": "purple",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 10,
              "width": 12,
              "height": 1
            }
          },
          {
            "id": 8423474886405506,
            "definition": {
              "title": "Drain status details per cluster",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Total",
                      "limit": {
                        "count": 1000,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "InScope",
                      "conditional_formats": [
                        {
                          "value": 0,
                          "palette": "green_on_white",
                          "comparator": ">",
                          "custom_fg_color": "#6464ff"
                        }
                      ],
                      "formula": "query2"
                    },
                    {
                      "alias": "Scheduled",
                      "conditional_formats": [
                        {
                          "value": 0,
                          "palette": "green_on_white",
                          "comparator": ">",
                          "custom_fg_color": "#6464ff"
                        }
                      ],
                      "formula": "query3"
                    },
                    {
                      "alias": "Completed",
                      "conditional_formats": [
                        {
                          "value": 0,
                          "palette": "custom_text",
                          "comparator": ">",
                          "custom_fg_color": "#6464ff"
                        }
                      ],
                      "formula": "query4"
                    },
                    {
                      "alias": "Failed",
                      "conditional_formats": [
                        {
                          "value": 0,
                          "palette": "red_on_white",
                          "comparator": ">",
                          "custom_fg_color": "#6464ff"
                        }
                      ],
                      "formula": "query5"
                    },
                    {
                      "alias": "Error",
                      "conditional_formats": [
                        {
                          "value": 0,
                          "palette": "red_on_white",
                          "comparator": ">",
                          "custom_fg_color": "#6464ff"
                        }
                      ],
                      "formula": "query6"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,app:draino-standard,!drain_status:none,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,app:draino-standard,!drain_status:none,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:scheduled,app:draino-standard,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:completed,app:draino-standard,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query4",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:failed,app:draino-standard,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query5",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:error,app:draino-standard,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query6",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 0,
              "y": 11,
              "width": 4,
              "height": 4
            }
          },
          {
            "id": 757323143887092,
            "definition": {
              "type": "note",
              "content": "Node current handled by `draino`:\n\nIdeally `Failed` count  should be 0, while nodes should move from `Scheduled` to `Completed`.\n\nHigh `Scheduled` value means that there are a lot of drain activity `pending` or `running`\n\nHigh `Completed` value may reflect the fact that CA is not able to prune empty nodes.",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 4,
              "y": 11,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 1689591741712250,
            "definition": {
              "title": "Node per Drain status",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "All",
                      "limit": {
                        "count": 100,
                        "order": "asc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "Scheduled",
                      "conditional_formats": [
                        {
                          "custom_fg_color": "#6464ff",
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "formula": "query2"
                    },
                    {
                      "alias": "Completed",
                      "conditional_formats": [
                        {
                          "custom_fg_color": "#6464ff",
                          "palette": "custom_text",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "formula": "query3"
                    },
                    {
                      "alias": "Failed",
                      "conditional_formats": [
                        {
                          "custom_fg_color": "#6464ff",
                          "palette": "red_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "formula": "query4"
                    },
                    {
                      "alias": "Error",
                      "conditional_formats": [
                        {
                          "custom_fg_color": "#6464ff",
                          "palette": "red_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "formula": "query5"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,app:draino-standard,!drain_status:none,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,nodegroup_name,nodegroup_namespace,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:scheduled,app:draino-standard,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,nodegroup_name,nodegroup_namespace,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:completed,app:draino-standard,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,nodegroup_name,nodegroup_namespace,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:failed,app:draino-standard,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,nodegroup_name,nodegroup_namespace,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query4",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,drain_status:error,app:draino-standard,!conditions:any,in_scope:true,$kube_cluster_name} by {datacenter,nodegroup_name,nodegroup_namespace,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query5",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "always"
            },
            "layout": {
              "x": 6,
              "y": 11,
              "width": 6,
              "height": 6
            }
          },
          {
            "id": 8978393501436236,
            "definition": {
              "type": "note",
              "content": "Filtering by nodegroup or by kubernetes cluster should allow you to have a better precise view since the breakdown returns a lot of details.\n\nOnly NG in scope are represented here.\n\nNote that sorting by anything else than `InScope` would filter out some data (bug in the widget)",
              "background_color": "purple",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 4,
              "y": 13,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5282842584393476,
            "definition": {
              "title": "Node being process by drain - distribution in status (Scheduled|Completed|Failed)",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query2"
                    },
                    {
                      "formula": "query3"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,!conditions:any,drain_status:completed,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,!conditions:any,drain_status:scheduled,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query"
                    },
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,!conditions:any,drain_status:error,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,!conditions:any,drain_status:failed,$kube_cluster_name} by {drain_status,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 15,
              "width": 6,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 3,
        "width": 12,
        "height": 18
      }
    },
    {
      "id": 7708500101102508,
      "definition": {
        "title": "Nodes in scope of NLA a specific condition [ For Maintainers ]  -->  MUST SELECT A SPECIF CONDITION IN FILTERS ",
        "type": "group",
        "background_color": "gray",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3643951807334258,
            "definition": {
              "type": "note",
              "content": "!!! This group is to relevant only if the filter `condition` is set to a specific value !!!",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 5,
              "height": 1
            }
          },
          {
            "id": 5875761948972562,
            "definition": {
              "type": "note",
              "content": "",
              "background_color": "gray",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 1,
              "height": 11
            }
          },
          {
            "id": 5991858968515354,
            "definition": {
              "type": "note",
              "content": "This group give some more details per conditions compare to first group\n\nText Filter in table applies only on the Top elements --> use the template at the top of the page for a correct filtering",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 6,
              "height": 1
            }
          },
          {
            "id": 3267953693262066,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 6403527805331178,
            "definition": {
              "title": "Nodes in scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1284097298691016,
            "definition": {
              "title": "Nodes out of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:false,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "nds",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 8217124501354294,
            "definition": {
              "title": "Node in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 1,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 4233355766100192,
            "definition": {
              "title": "Top 50  conditions for a given cluster: in-scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions,kube_cluster_name,datacenter}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 6,
              "y": 1,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 7633829703152656,
            "definition": {
              "title": "Top 50  conditions for a given cluster: out-scope",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions,datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 9,
              "y": 1,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6254526932764740,
            "definition": {
              "title": "InScope ratio % per cluster (0% do not appear)",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 50,
                        "order": "asc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:true,$conditions,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,$conditions,$kube_cluster_name} by {kubernetes_cluster}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 4573318362139322,
            "definition": {
              "title": "Top 100 NG with condition(s) (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "comparator": ">",
                          "value": 0
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 6,
              "y": 4,
              "width": 6,
              "height": 7
            }
          },
          {
            "id": 7467676018451562,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:false,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6525072437002530,
            "definition": {
              "title": "Node out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,app:draino-standard,in_scope:false,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 6,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 1277966241156488,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 9,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 21,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 5485166690364998,
      "definition": {
        "title": "Cordon activity [ For maintainers ]",
        "type": "group",
        "background_color": "blue",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 4102362175799090,
            "definition": {
              "title": "Reasons for cordon activity skipped",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_skipped_cordon_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {reason}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6523792993309244,
            "definition": {
              "title": "Cordon activity skipped per NG",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_skipped_cordon_total{$datacenter,$ng_namespace,$ng_name,$team,!nodegroup_name:,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4763922519864042,
            "definition": {
              "type": "note",
              "content": "The nodes on which the cordon activity is skipped are counted on the node out of scope. In previous section.\n\nHere we count the cordon/drain activities that are skipped for eligible nodes but with workload (pod) that is not compliant.\n\n`pod-annotation` represents the volume of pods that have explicitly opt-out.",
              "background_color": "blue",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 1,
              "height": 4
            }
          },
          {
            "id": 2280824799812764,
            "definition": {
              "type": "note",
              "content": "Clusters and NG that stay at their cordon limit for a long period reflects the fact that NLA cannot progress on that cluster or nodegroup.\n\nIt worth checking if we are not in one of the following case:\n- many node block with drain failed\n- cluster-autoscaler can't scale-down empty nodes\n- - MinSize>1 on the NG\n- - CA in cool-down or scaleup loop or not working\n- users have manually cordon many nodes\n- too many notReady nodes\n- too many pending pods",
              "background_color": "orange",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "25%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 1,
              "height": 8
            }
          },
          {
            "id": 13759596936320,
            "definition": {
              "title": "Clusters that have reached MaxCordon limit",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1 / query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordon:*,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {datacenter,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7803499812443874,
            "definition": {
              "title": "Global block at Cluster level: Too much NotReadyNodes or too much Pending pods",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "min:draino.draino_global_block{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {block,kube_cluster_name}.rollup(min, 180)",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "red",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " any cluster appearing here is blocked for any Node Lifecycle Activity. Check the name of the blocker by moving the mouse on the bar. ",
                  "value": "y = 0",
                  "display_type": "error dashed"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 4027449102608026,
            "definition": {
              "title": "Reasons for cordon activity skipped",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1w"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "week_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_skipped_cordon_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {reason}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "relative"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8942465011451154,
            "definition": {
              "title": "Cordon activity skipped per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_skipped_cordon_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 2,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2315765247355520,
            "definition": {
              "title": "Nodegroups that have reached NG-MaxCordon limit",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1 / query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordonlimiterforlabels:*,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 2,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 717237193483322,
            "definition": {
              "title": "Count of nodes being cordon by `draino`  per cluster",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$conditions,$ng_namespace,$team,$ng_name,!drain_status:none,app:draino-standard,!conditions:any,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "purple",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " MaxCordon=25 for stateless application ",
                  "value": "y = 25",
                  "display_type": "error bold"
                },
                {
                  "label": " MaxCordon=40 for stateful application ",
                  "value": "y = 40",
                  "display_type": "error bold"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 4091588426756884,
            "definition": {
              "type": "note",
              "content": "Normal cordon activity for NLA.\nAll filters (nodes and pods) are ok.\nNo limit reached on the cluster or the NG.",
              "background_color": "green",
              "font_size": "14",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "25%",
              "tick_edge": "bottom",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 4,
              "width": 5,
              "height": 1
            }
          },
          {
            "id": 5400294731273338,
            "definition": {
              "title": "Cluster(s) that have reached MaxCordon limit",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "top(query1 / query1, 10, 'mean', 'desc')"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordon:*,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {datacenter,kube_cluster_name,app}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " any cluster above that line has reached its cordon threshold.     Being for a long period above that line is a sign that something is blocked on the cluster  ",
                  "value": "y = 0",
                  "display_type": "error dashed"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 4,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 2538498334271198,
            "definition": {
              "title": "Cordon activity",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_cordoned_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 5,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 8421478033294900,
            "definition": {
              "title": "Cordon activity",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_cordoned_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {datacenter,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 264414044990420,
            "definition": {
              "title": "Taints that have reached NG-MaxCordon limit",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1 / query2",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordonlimiterfortaints:*,$ng_namespace,$ng_name,$team,$conditions,$datacenter,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordonlimiterfortaints:*,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 2369194662646716,
            "definition": {
              "title": "NG that have reached MaxCordon limit",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "top(query1 / query1, 10, 'mean', 'desc')"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_limited_cordon_total{reason:maxsimultaneouscordonlimiterforlabels:*,$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " any NG above that line has reached its cordon threshold.     Being for a long period above that line is a sign that something is blocked on that NG ",
                  "value": "y = 0",
                  "display_type": "error dashed"
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 6,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 22,
        "width": 12,
        "height": 1
      }
    },
    {
      "id": 5309358840670748,
      "definition": {
        "title": "Drain failures [ For maintainers ]",
        "type": "group",
        "background_color": "orange",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3460947783460462,
            "definition": {
              "title": "Drain failure cause evolution over week",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "desc",
                  "response_format": "scalar",
                  "show_present": true,
                  "increase_good": false,
                  "queries": [
                    {
                      "query": "top(sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count(), 10, \"sum\", \"desc\")",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 281988546734666,
            "definition": {
              "title": "Top drain failure cause",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8182803832166418,
            "definition": {
              "title": "Top drain failure per NG",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 4,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2556704129298930,
            "definition": {
              "title": "Top drain failure per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 10,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5815134629560906,
            "definition": {
              "title": "Node drain failures and causes",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_drained_nodes_total{result:failed,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {failure_cause,kube_cluster_name}.as_count()",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 4,
              "height": 2
            }
          },
          {
            "id": 5320765848923344,
            "definition": {
              "type": "note",
              "content": "Permanent failures represents node for which automatic retry has failed more that 7 times.\nThe system then give up.\nThe node is uncordon and it is annotated with:\n`draino/drain-retry-failed: failed`\n\n[link to list of nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23draino%2Fdrain-retry-failed%3Afailed&paused=false)\n\nTo purge the NLA history on that node and restart a complete cycle from the beginning change the value of the annotation:\n`draino/drain-retry-failed: restart`",
              "background_color": "vivid_orange",
              "font_size": "14",
              "text_align": "left",
              "vertical_align": "center",
              "show_tick": true,
              "tick_pos": "25%",
              "tick_edge": "right",
              "has_padding": true
            },
            "layout": {
              "x": 4,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3273617787035484,
            "definition": {
              "title": "Permanent failure",
              "title_size": "16",
              "title_align": "left",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,drain_retry_failed:true,conditions:any,app:draino-standard,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 2,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7622677039443004,
            "definition": {
              "title": "Permanent failure",
              "title_size": "16",
              "title_align": "left",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$ng_name,$team,drain_retry_failed:true,conditions:any,app:draino-standard,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 8,
              "y": 2,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 23,
        "width": 12,
        "height": 5,
        "is_column_break": true
      }
    },
    {
      "id": 4709611263760734,
      "definition": {
        "title": "Feature: preprovisioning",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5980217962865516,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23node-lifecycle.datadoghq.com%2Fprovision-new-node-before-drain%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 1464465413262190,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 3884288874956624,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6918473263694964,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2157215042598504,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6152241964374510,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,preprovisioning:true,$datacenter,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 2870777055911904,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 3407299307600446,
            "definition": {
              "title": "Number of nodes OUT of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,preprovisioning:true,app:draino-standard,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 28,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 8582675326216548,
      "definition": {
        "title": "Feature: pvc management",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3357326972004282,
            "definition": {
              "type": "note",
              "content": "link to [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=annotation%23draino%2Fdelete-pvc-and-pv%3Atrue&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=annotation%23draino%2Fdelete-pvc-and-pv%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 6101614011237702,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1803839147126590,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7974928941284808,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5998155848479010,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 2783372916178758,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,pvc_management:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 4514195184299708,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,in_scope:true*,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1377123385895790,
            "definition": {
              "title": "Number of nodes OUT of scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,pvc_management:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 31,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 5551490132657834,
      "definition": {
        "title": "Feature: drain retry",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 6048291701448336,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=annotation%23draino%2Fdrain-retry%3Atrue&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 8176313131797116,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 2238493323351402,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8907444524023096,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8497813126918522,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 483456555713558,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,drain_retry:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 4873969492474464,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1245244384400038,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,drain_retry:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 34,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 1539097608731504,
      "definition": {
        "title": "Feature: eviction++ url",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1812038611998916,
            "definition": {
              "type": "note",
              "content": "link to [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=annotation%23draino%2Feviction-api-url%3A%2A&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=annotation%23draino%2Feviction-api-url%3A%2A&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 7975169297458104,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 6846336810364662,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5350201804727372,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5744437128299896,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 4026412961817574,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,eviction_url:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 8692133250777212,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 1350140128036796,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,eviction_url:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 37,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 7537549973247164,
      "definition": {
        "title": "Feature: user opt-out",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 8540343693386668,
            "definition": {
              "type": "note",
              "content": "link to [nodes](https://app.datadoghq.com/orchestration/overview/node?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) [deployment](https://app.datadoghq.com/orchestration/overview/deployment?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 4571618321899692,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 1187743876967728,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8472352685346132,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 6117333180622830,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "on_right_yaxis": false,
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3715951164067492,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,user_opt_out_via_pod_annotation:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 539437336994560,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 8228191989677458,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_out_via_pod_annotation:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 40,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 6161816318816972,
      "definition": {
        "title": "Feature: user opt-in",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 1421312419550774,
            "definition": {
              "type": "note",
              "content": "link to [nodes](https://app.datadoghq.com/orchestration/overview/node?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) [statefulsets](https://app.datadoghq.com/orchestration/overview/statefulSet?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) [deployment](https://app.datadoghq.com/orchestration/overview/deployment?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true) and [pods](https://app.datadoghq.com/orchestration/overview/pod?query=label%23node-lifecycle.datadoghq.com%2Fenabled%3Afalse&paused=true)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 2734235425777792,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 8464380871895574,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 847250637726096,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5200793595908224,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 7806640292704436,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,user_opt_in_via_pod_annotation:true,$ng_namespace,$ng_name,$team,$conditions,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 1188197115636516,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 2299075389880718,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 43,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 3917229782842188,
      "definition": {
        "title": "Feature: user specific condition",
        "type": "group",
        "background_color": "vivid_green",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 3632045483726858,
            "definition": {
              "type": "note",
              "content": "[link to nodes](https://app.datadoghq.com/orchestration/overview/node?query=tag%23draino%2Fnode-conditions%3A%2A&paused=false)",
              "background_color": "white",
              "font_size": "24",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 2,
              "height": 1
            }
          },
          {
            "id": 5316051024805018,
            "definition": {
              "title": "% of nodes",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "(100 * query1) / query2"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 2,
              "y": 0,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 3086206552562880,
            "definition": {
              "title": "Number of nodes using the feature per cluster",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 25,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 3434543215242242,
            "definition": {
              "title": "Feature usage over time in clusters",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5436036677808686,
            "definition": {
              "title": "Feature usage over time per nodegroup",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 7,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 8115140040734690,
            "definition": {
              "title": "Evolution of usage",
              "title_size": "16",
              "title_align": "left",
              "time": {
                "live_span": "1d"
              },
              "type": "change",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "day_before(query1)"
                    },
                    {
                      "formula": "query1"
                    }
                  ],
                  "order_by": "change",
                  "order_dir": "asc",
                  "compare_to": "hour_before",
                  "response_format": "scalar",
                  "increase_good": true,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{conditions:any,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,user_allowed_conditions_annotation:true,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "sum"
                    }
                  ],
                  "change_type": "absolute"
                }
              ]
            },
            "layout": {
              "x": 9,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7367789757762526,
            "definition": {
              "title": "Number of nodes IN scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,user_opt_in_via_pod_annotation:true,$conditions,in_scope:true,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 1
            }
          },
          {
            "id": 763536452837436,
            "definition": {
              "title": "Number of nodes OUT scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_nodes_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,$conditions,in_scope:false,user_allowed_conditions_annotation:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 1
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 46,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 4077740151293666,
      "definition": {
        "title": "CPU in scope of NLA [ For all users ]",
        "type": "group",
        "background_color": "purple",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 5801848886462402,
            "definition": {
              "type": "note",
              "content": "This group is to reveal the number of nodes in scope **overall**.\n\nIf you are interested by only a specific `condition`, select a value in the *conditions* filter and go to the dedicated group under this one.",
              "background_color": "vivid_purple",
              "font_size": "18",
              "text_align": "center",
              "vertical_align": "center",
              "show_tick": false,
              "tick_pos": "50%",
              "tick_edge": "left",
              "has_padding": true
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 1
            }
          },
          {
            "id": 1734945488969672,
            "definition": {
              "title": "CPUs in scope per condition",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {conditions}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4611597749074084,
            "definition": {
              "title": "Top 100 NG in CPU count (use sort to switch category)",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 100,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 5,
              "y": 0,
              "width": 3,
              "height": 5
            }
          },
          {
            "id": 4198682471884760,
            "definition": {
              "title": "CPUs in scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#04f604",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#1f7a00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#1a4f08",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#063706",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "custom_bg_color": "#051a05",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 1200173675326860,
            "definition": {
              "title": "CPUs out of scope per NG",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#f60404",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 100
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "custom_bg_color": "#7a1f00",
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 25
                    },
                    {
                      "custom_bg_color": "#370606",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 12
                    },
                    {
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {nodegroup_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 10,
              "y": 0,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 4087938201264562,
            "definition": {
              "title": "NLA Overall Coverage",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "%",
              "precision": 2
            },
            "layout": {
              "x": 0,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 5952012919660484,
            "definition": {
              "title": "CPUs in scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "green_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "CPUs",
              "precision": 0
            },
            "layout": {
              "x": 1,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 2430778181213064,
            "definition": {
              "title": "CPUs out of scope",
              "type": "query_value",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "conditional_formats": [
                    {
                      "comparator": ">",
                      "palette": "yellow_on_white",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,$kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "autoscale": false,
              "custom_unit": "CPU",
              "precision": 0
            },
            "layout": {
              "x": 2,
              "y": 1,
              "width": 1,
              "height": 2
            }
          },
          {
            "id": 7885350626683318,
            "definition": {
              "title": "In vs Out of scope",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "green",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                },
                {
                  "formulas": [
                    {
                      "formula": "-query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:false,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "orange",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "area"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 3,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 487199249592496,
            "definition": {
              "title": "InScope ratio % per cluster1",
              "type": "toplist",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "conditional_formats": [
                    {
                      "custom_bg_color": "#2a8d43",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 90
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_green",
                      "value": 75
                    },
                    {
                      "custom_bg_color": "#16587f",
                      "comparator": ">",
                      "palette": "custom_bg",
                      "value": 50
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_yellow",
                      "value": 25
                    },
                    {
                      "comparator": ">",
                      "palette": "white_on_red",
                      "value": 0
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 3,
              "width": 2,
              "height": 5
            }
          },
          {
            "id": 2730714035803450,
            "definition": {
              "title": "CPUs in scope per cluster",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "CPU count",
                      "cell_display_mode": "bar",
                      "limit": {
                        "count": 1000,
                        "order": "desc"
                      },
                      "formula": "query1"
                    },
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query2"
                    },
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "cell_display_mode": "bar",
                      "formula": "query3"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2",
                      "aggregator": "last"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,conditions:any,!nodegroup_name_prefix:,$kube_cluster_name} by {datacenter,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query3",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "auto"
            },
            "layout": {
              "x": 5,
              "y": 5,
              "width": 3,
              "height": 3
            }
          },
          {
            "id": 6611737061864436,
            "definition": {
              "title": "Top 50 NG in-scope  with condition(s) in CPU count",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "in-scope",
                      "conditional_formats": [
                        {
                          "palette": "green_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:true,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 8,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 4556362726140242,
            "definition": {
              "title": "Top 50 NG out-scope with condition(s) in CPU count",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "out-scope",
                      "conditional_formats": [
                        {
                          "palette": "yellow_on_white",
                          "value": 0,
                          "comparator": ">"
                        }
                      ],
                      "limit": {
                        "count": 50,
                        "order": "desc"
                      },
                      "cell_display_mode": "bar",
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{in_scope:false,app:draino-standard,$datacenter,$ng_namespace,$ng_name,$team,$conditions,!conditions:any,$kube_cluster_name} by {nodegroup_name,conditions,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ],
              "has_search_bar": "never"
            },
            "layout": {
              "x": 10,
              "y": 5,
              "width": 2,
              "height": 3
            }
          },
          {
            "id": 3055409049932458,
            "definition": {
              "title": "InScope ratio % per cluster",
              "show_legend": true,
              "legend_layout": "horizontal",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "100 * query1 / (query2)"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,in_scope:true,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    },
                    {
                      "query": "sum:draino.draino_node_options_cpu_total{$datacenter,$ng_namespace,$team,$ng_name,conditions:any,app:draino-standard,!nodegroup_name_prefix:,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query2"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "min": "0",
                "max": "100"
              },
              "markers": []
            },
            "layout": {
              "x": 0,
              "y": 6,
              "width": 3,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 49,
        "width": 12,
        "height": 9
      }
    },
    {
      "id": 1406336625253506,
      "definition": {
        "title": "Nodes status",
        "type": "group",
        "background_color": "vivid_yellow",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 483215088732880,
            "definition": {
              "title": "Node lifetime - Cluster Average",
              "show_legend": false,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "forecast(query1, 'linear', 1)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime_hours{$datacenter,$ng_namespace,$ng_name,$kube_cluster_name} by {kubernetes_cluster,datacenter}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                },
                {
                  "formulas": [
                    {
                      "formula": "forecast(query1, \"linear\", 1)"
                    }
                  ],
                  "response_format": "timeseries",
                  "on_right_yaxis": false,
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime{$datacenter,$ng_namespace,*,$ng_name,$kube_cluster_name} by {kubernetes_cluster,datacenter}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "cool",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "line"
                }
              ],
              "yaxis": {
                "include_zero": true,
                "scale": "linear",
                "label": "",
                "min": "auto",
                "max": "auto"
              },
              "markers": [
                {
                  "label": " 90 Days ",
                  "value": "y = 2160",
                  "display_type": "error dashed"
                },
                {
                  "label": " 30 Days ",
                  "value": "y = 720",
                  "display_type": "warning dashed"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 1363728755141114,
            "definition": {
              "title": "Node lifetime - Team Average",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "alias": "Node Lifetime average",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      },
                      "formula": "query1"
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "avg:k8s_datadog_node_problem_detector.node_lifetime{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kubernetes_cluster,datacenter,team}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "last"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 3,
              "y": 0,
              "width": 3,
              "height": 2
            }
          },
          {
            "id": 7991587368828250,
            "definition": {
              "title": "",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "sum:k8s_node_metadata_controller.node_out_of_date{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 6,
              "y": 0,
              "width": 2,
              "height": 2
            }
          },
          {
            "id": 5180322712433436,
            "definition": {
              "title": "",
              "title_size": "16",
              "title_align": "left",
              "type": "query_table",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1",
                      "limit": {
                        "count": 500,
                        "order": "desc"
                      }
                    }
                  ],
                  "response_format": "scalar",
                  "queries": [
                    {
                      "query": "sum:k8s_node_metadata_controller.node_out_of_date{$datacenter,$ng_namespace,$ng_name,$team,$kube_cluster_name} by {kube_cluster_name,nodegroups.datadoghq.com/name}",
                      "data_source": "metrics",
                      "name": "query1",
                      "aggregator": "avg"
                    }
                  ]
                }
              ]
            },
            "layout": {
              "x": 8,
              "y": 0,
              "width": 2,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 58,
        "width": 12,
        "height": 3
      }
    },
    {
      "id": 1350557661640550,
      "definition": {
        "title": "Zonal Clusters",
        "type": "group",
        "background_color": "vivid_blue",
        "show_title": true,
        "layout_type": "ordered",
        "widgets": [
          {
            "id": 6762822465645054,
            "definition": {
              "title": "Zonal clusters: partition open for eviction",
              "title_size": "16",
              "title_align": "left",
              "show_legend": true,
              "legend_layout": "auto",
              "legend_columns": [
                "avg",
                "min",
                "max",
                "value",
                "sum"
              ],
              "type": "timeseries",
              "requests": [
                {
                  "formulas": [
                    {
                      "formula": "query1"
                    }
                  ],
                  "response_format": "timeseries",
                  "queries": [
                    {
                      "query": "max:disruption_budget_manager.time_partition{reason:,$datacenter,$kube_cluster_name} by {partition,kube_cluster_name}",
                      "data_source": "metrics",
                      "name": "query1"
                    }
                  ],
                  "style": {
                    "palette": "dog_classic",
                    "line_type": "solid",
                    "line_width": "normal"
                  },
                  "display_type": "bars"
                }
              ]
            },
            "layout": {
              "x": 0,
              "y": 0,
              "width": 4,
              "height": 2
            }
          }
        ]
      },
      "layout": {
        "x": 0,
        "y": 61,
        "width": 12,
        "height": 3
      }
    }
  ],
  "template_variables": [
    {
      "name": "datacenter",
      "prefix": "datacenter",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "kubernetes_cluster",
      "prefix": "kubernetes_cluster",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "kube_cluster_name",
      "prefix": "kube_cluster_name",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "ng_namespace",
      "prefix": "nodegroup_namespace",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "ng_name",
      "prefix": "nodegroup_name",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "team",
      "prefix": "team",
      "available_values": [],
      "default": "*"
    },
    {
      "name": "conditions",
      "prefix": "conditions",
      "available_values": [],
      "default": "*"
    }
  ],
  "layout_type": "ordered",
  "is_read_only": false,
  "notify_list": [],
  "reflow_type": "fixed",
  "id": "84p-xk3-aga"
}
